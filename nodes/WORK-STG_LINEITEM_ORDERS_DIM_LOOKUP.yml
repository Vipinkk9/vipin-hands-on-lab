steps:
  STG_LINEITEM_ORDERS_DIM_LOOKUP-ffebc1a0-c13e-4199-a7d4-70290db1dcb7:
    operation:
      config:
        insertStrategy: INSERT
        postSQL: ""
        preSQL: ""
        testsEnabled: true
        truncateBefore: true
      database: ""
      deployEnabled: true
      description: ""
      isMultisource: false
      locationName: WORK
      materializationType: table
      metadata:
        appliedNodeTests: []
        columns:
          - columnReference:
              columnCounter: ac986410-2c7f-4df9-8fd0-71941b4d3410
              stepCounter: ffebc1a0-c13e-4199-a7d4-70290db1dcb7
            dataType: NUMBER(38,0)
            description: ""
            hashColumns: []
            hashDetails: null
            name: O_CUSTKEY
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 52a0a5c6-3321-4867-9ca7-ef4bf07587b9
                    stepCounter: 38566221-a625-403b-bec5-6066f9fe995b
                transform: ""
          - columnReference:
              columnCounter: 3ef320e6-ecdf-42e3-9be8-259c97069ed2
              stepCounter: ffebc1a0-c13e-4199-a7d4-70290db1dcb7
            dataType: NUMBER
            description: ""
            name: DIM_CUSTOMER_KEY
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: b1c6de60-c504-461f-a0ea-f00d25bec56d
                    stepCounter: 4cbeb489-23a8-46b4-ade4-ef52553daa6f
                transform: ""
          - columnReference:
              columnCounter: fed26927-4b28-459d-b1b1-6650b5ba3af7
              stepCounter: ffebc1a0-c13e-4199-a7d4-70290db1dcb7
            dataType: NUMBER
            description: ""
            name: DIM_PART_KEY
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 1cd4a013-4abd-43cd-8e81-737979cf4b28
                    stepCounter: dff448f4-b80b-4f5d-9f35-2e3055e15a4d
                transform: ""
          - columnReference:
              columnCounter: de8721a5-b324-4fe6-a765-756e61989400
              stepCounter: ffebc1a0-c13e-4199-a7d4-70290db1dcb7
            dataType: NUMBER
            description: ""
            name: DIM_SUPPLIER_KEY
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 761b383b-dd8c-48bc-a2d2-5982be8b7bd6
                    stepCounter: 64151fd1-1974-4ac3-a58f-b21e0f9c817c
                transform: ""
          - columnReference:
              columnCounter: 49896d91-9e91-473b-9cc1-34cd830eb44b
              stepCounter: ffebc1a0-c13e-4199-a7d4-70290db1dcb7
            dataType: NUMBER(38,0)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_SUPPKEY
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 719cec89-3fd9-402f-8868-9e910e79eaf5
                    stepCounter: 38566221-a625-403b-bec5-6066f9fe995b
                transform: ""
          - columnReference:
              columnCounter: 7b7ac776-daa5-48c8-938b-c8ca99baf528
              stepCounter: ffebc1a0-c13e-4199-a7d4-70290db1dcb7
            dataType: NUMBER(38,0)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_PARTKEY
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: e3331784-30ae-4902-af6b-09269f75b283
                    stepCounter: 38566221-a625-403b-bec5-6066f9fe995b
                transform: ""
          - columnReference:
              columnCounter: 6f2313cf-7227-4721-aca5-df547da89683
              stepCounter: ffebc1a0-c13e-4199-a7d4-70290db1dcb7
            dataType: NUMBER(38,0)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_ORDERKEY
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: cee2e1ab-2c35-401f-a334-cc4560bb1130
                    stepCounter: 38566221-a625-403b-bec5-6066f9fe995b
                transform: ""
          - columnReference:
              columnCounter: 12261041-a1cf-44fe-953b-21d015014223
              stepCounter: ffebc1a0-c13e-4199-a7d4-70290db1dcb7
            dataType: NUMBER(38,0)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_LINENUMBER
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 4dcc9007-48ab-4694-be77-b16e5664e37c
                    stepCounter: 38566221-a625-403b-bec5-6066f9fe995b
                transform: ""
          - columnReference:
              columnCounter: b4bb5ca4-d700-4a48-b90c-b8ad47d84711
              stepCounter: ffebc1a0-c13e-4199-a7d4-70290db1dcb7
            dataType: NUMBER(12,2)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_QUANTITY
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 30bb34b4-2d59-444f-bd2a-52276b5d0daf
                    stepCounter: 38566221-a625-403b-bec5-6066f9fe995b
                transform: ""
          - columnReference:
              columnCounter: 1ac071b8-26ba-4c97-be6c-98010405f506
              stepCounter: ffebc1a0-c13e-4199-a7d4-70290db1dcb7
            dataType: NUMBER(12,2)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_EXTENDEDPRICE
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 1451e418-4d9b-4a6c-9069-79db9a235c70
                    stepCounter: 38566221-a625-403b-bec5-6066f9fe995b
                transform: ""
          - columnReference:
              columnCounter: f3707834-667f-4c0f-855a-133c0a937556
              stepCounter: ffebc1a0-c13e-4199-a7d4-70290db1dcb7
            dataType: NUMBER(12,2)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_DISCOUNT
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: b3c46231-4992-4302-ac2d-18066b50ebe8
                    stepCounter: 38566221-a625-403b-bec5-6066f9fe995b
                transform: ""
          - columnReference:
              columnCounter: 0eda05a9-78b6-4e7d-bfc1-4d5e584e1eaa
              stepCounter: ffebc1a0-c13e-4199-a7d4-70290db1dcb7
            dataType: NUMBER(12,2)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_TAX
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 923826d4-8f78-413d-a600-001334149f0d
                    stepCounter: 38566221-a625-403b-bec5-6066f9fe995b
                transform: ""
          - columnReference:
              columnCounter: f40c31fa-c7be-40ae-bc95-45603d56219e
              stepCounter: ffebc1a0-c13e-4199-a7d4-70290db1dcb7
            dataType: VARCHAR(1)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_RETURNFLAG
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: a3927f49-6ab5-4ddb-bcff-44c217e8129e
                    stepCounter: 38566221-a625-403b-bec5-6066f9fe995b
                transform: ""
          - columnReference:
              columnCounter: db409b9a-e0c4-48d2-99a7-aa3f85b1ecb0
              stepCounter: ffebc1a0-c13e-4199-a7d4-70290db1dcb7
            dataType: VARCHAR(1)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_LINESTATUS
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 9a5a6d75-bdf5-4864-9bec-be693d8613fe
                    stepCounter: 38566221-a625-403b-bec5-6066f9fe995b
                transform: ""
          - columnReference:
              columnCounter: 21681fa3-400b-487c-b761-99bf25f13576
              stepCounter: ffebc1a0-c13e-4199-a7d4-70290db1dcb7
            dataType: DATE
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_SHIPDATE
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: f25d8eba-a763-4469-8f17-4ad077967be2
                    stepCounter: 38566221-a625-403b-bec5-6066f9fe995b
                transform: ""
          - columnReference:
              columnCounter: 67e88edf-e850-490b-a83d-d518833e14cb
              stepCounter: ffebc1a0-c13e-4199-a7d4-70290db1dcb7
            dataType: DATE
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_COMMITDATE
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 56202a9b-1073-4087-9a41-2bcd691a5694
                    stepCounter: 38566221-a625-403b-bec5-6066f9fe995b
                transform: ""
          - columnReference:
              columnCounter: 9b5be572-b804-43fd-9b86-3b0674c27910
              stepCounter: ffebc1a0-c13e-4199-a7d4-70290db1dcb7
            dataType: DATE
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_RECEIPTDATE
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 9e09bdb8-c744-41e1-998f-624c00364497
                    stepCounter: 38566221-a625-403b-bec5-6066f9fe995b
                transform: ""
          - columnReference:
              columnCounter: 5548cfbd-3c41-4fe5-91d6-547823d55844
              stepCounter: ffebc1a0-c13e-4199-a7d4-70290db1dcb7
            dataType: VARCHAR(25)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_SHIPINSTRUCT
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 69911066-ca38-491c-9c20-f1bfb6e74979
                    stepCounter: 38566221-a625-403b-bec5-6066f9fe995b
                transform: ""
          - columnReference:
              columnCounter: 220d6991-f9cc-4075-beb6-cdab81da967a
              stepCounter: ffebc1a0-c13e-4199-a7d4-70290db1dcb7
            dataType: VARCHAR(10)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_SHIPMODE
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: b7b8161d-3ffb-415e-97a4-e078f9d759ac
                    stepCounter: 38566221-a625-403b-bec5-6066f9fe995b
                transform: ""
          - columnReference:
              columnCounter: ad661f26-234e-4cf2-8e53-f24531dd0f59
              stepCounter: ffebc1a0-c13e-4199-a7d4-70290db1dcb7
            dataType: VARCHAR(44)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_COMMENT
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 57ab922d-01ac-46a5-9897-21e315ecec2b
                    stepCounter: 38566221-a625-403b-bec5-6066f9fe995b
                transform: ""
          - columnReference:
              columnCounter: 8667a3d4-5db6-47f8-bd68-cad76dbe950a
              stepCounter: ffebc1a0-c13e-4199-a7d4-70290db1dcb7
            dataType: NUMBER(38,0)
            description: ""
            hashColumns: []
            hashDetails: null
            name: O_ORDERKEY
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: dc3255b0-ce42-4a91-8808-1e5ad06cceb1
                    stepCounter: 38566221-a625-403b-bec5-6066f9fe995b
                transform: ""
          - columnReference:
              columnCounter: 6b009e44-480c-4b3d-91f0-f9d9b2eef12d
              stepCounter: ffebc1a0-c13e-4199-a7d4-70290db1dcb7
            dataType: VARCHAR(1)
            description: ""
            hashColumns: []
            hashDetails: null
            name: O_ORDERSTATUS
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: f9e83c07-fa81-4ea4-b039-d74a032fea2e
                    stepCounter: 38566221-a625-403b-bec5-6066f9fe995b
                transform: ""
          - columnReference:
              columnCounter: 2cb28677-7cfb-489c-805c-a4ccec24a6f9
              stepCounter: ffebc1a0-c13e-4199-a7d4-70290db1dcb7
            dataType: NUMBER(12,2)
            description: ""
            hashColumns: []
            hashDetails: null
            name: O_TOTALPRICE
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: c142e1cc-582a-48f9-9c06-b7344860ffe1
                    stepCounter: 38566221-a625-403b-bec5-6066f9fe995b
                transform: ""
          - columnReference:
              columnCounter: 346c2e21-9810-4050-b66a-5e25980e2b24
              stepCounter: ffebc1a0-c13e-4199-a7d4-70290db1dcb7
            dataType: DATE
            description: ""
            hashColumns: []
            hashDetails: null
            name: O_ORDERDATE
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 63e42118-46e2-4bea-b3c5-92076fc002e6
                    stepCounter: 38566221-a625-403b-bec5-6066f9fe995b
                transform: ""
          - columnReference:
              columnCounter: 572080ae-2426-4899-8594-8c57a90d9660
              stepCounter: ffebc1a0-c13e-4199-a7d4-70290db1dcb7
            dataType: VARCHAR(15)
            description: ""
            hashColumns: []
            hashDetails: null
            name: O_ORDERPRIORITY_NUM
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: aa20ad23-6e31-4807-92c4-910cafd8d4d8
                    stepCounter: 38566221-a625-403b-bec5-6066f9fe995b
                transform: ""
          - columnReference:
              columnCounter: b89066f9-0f42-4e64-bb1f-09226bb46b93
              stepCounter: ffebc1a0-c13e-4199-a7d4-70290db1dcb7
            dataType: VARCHAR(15)
            description: ""
            hashColumns: []
            hashDetails: null
            name: O_ORDERPRIORITY_DESC
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 31a084a5-7653-4fa6-a0f4-3ee9254d61ad
                    stepCounter: 38566221-a625-403b-bec5-6066f9fe995b
                transform: ""
          - columnReference:
              columnCounter: 23d1a0d3-431f-49dd-9fa3-fc5ced8c0f2d
              stepCounter: ffebc1a0-c13e-4199-a7d4-70290db1dcb7
            dataType: VARCHAR(15)
            description: ""
            hashColumns: []
            hashDetails: null
            name: O_CLERK
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: a0c02e14-74ac-4ef4-83c7-8b95ba9171db
                    stepCounter: 38566221-a625-403b-bec5-6066f9fe995b
                transform: ""
          - columnReference:
              columnCounter: 5aac62cb-dd4f-49a3-9edb-60279a9023af
              stepCounter: ffebc1a0-c13e-4199-a7d4-70290db1dcb7
            dataType: NUMBER(38,0)
            description: ""
            hashColumns: []
            hashDetails: null
            name: O_SHIPPRIORITY
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 76107d50-8f32-444e-a638-6059cd1d0f9d
                    stepCounter: 38566221-a625-403b-bec5-6066f9fe995b
                transform: ""
          - columnReference:
              columnCounter: c40fb635-5756-4cd9-a41d-77c6a151bbfd
              stepCounter: ffebc1a0-c13e-4199-a7d4-70290db1dcb7
            dataType: VARCHAR(79)
            description: ""
            hashColumns: []
            hashDetails: null
            name: O_COMMENT
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: c3da0bdc-b275-469a-9588-023dfef420b4
                    stepCounter: 38566221-a625-403b-bec5-6066f9fe995b
                transform: ""
          - columnReference:
              columnCounter: 56736b63-9d4e-4b5a-ba1d-48ea1c07b24e
              stepCounter: ffebc1a0-c13e-4199-a7d4-70290db1dcb7
            dataType: NUMBER(38,0)
            description: ""
            hashColumns: []
            hashDetails: null
            name: DAYS TO SHIP
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 77c52eb5-ad55-4292-b0cf-7d68a19c2831
                    stepCounter: 38566221-a625-403b-bec5-6066f9fe995b
                transform: ""
          - acceptedValues:
              strictMatch: false
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: 6be1c471-906e-470d-a4ce-9a9562ee2755
              stepCounter: ffebc1a0-c13e-4199-a7d4-70290db1dcb7
            dataType: NUMBER(12,2)
            description: ""
            name: PS_SUPPLYCOST
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: b36d8c0c-cc88-47a5-b6f8-d13586665945
                    stepCounter: 38566221-a625-403b-bec5-6066f9fe995b
                transform: ""
          - acceptedValues:
              strictMatch: false
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: 36d5b335-5b5c-412b-8903-74df55fd4b66
              stepCounter: ffebc1a0-c13e-4199-a7d4-70290db1dcb7
            dataType: NUMBER(38,0)
            description: ""
            name: PS_AVAILQTY
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: d01d6bb4-6cc7-49e3-ae8a-0b65b1440f39
                    stepCounter: 38566221-a625-403b-bec5-6066f9fe995b
                transform: ""
        cteString: ""
        enabledColumnTestIDs: []
        sourceMapping:
          - aliases:
              DIM_CUSTOMER: 4cbeb489-23a8-46b4-ade4-ef52553daa6f
              DIM_PART: dff448f4-b80b-4f5d-9f35-2e3055e15a4d
              DIM_SUPPLIER: 64151fd1-1974-4ac3-a58f-b21e0f9c817c
              STG_LINEITEM_ORDERS: 38566221-a625-403b-bec5-6066f9fe995b
              STG_PARTSUPP: 4da0dfb9-e404-4118-99e4-4cee1a780d7a
            customSQL:
              customSQL: ""
            dependencies:
              - locationName: WORK
                nodeName: DIM_CUSTOMER
              - locationName: WORK
                nodeName: DIM_PART
              - locationName: WORK
                nodeName: DIM_SUPPLIER
              - locationName: WORK
                nodeName: STG_LINEITEM_ORDERS
              - locationName: WORK
                nodeName: STG_PARTSUPP
            join:
              joinCondition: |-
                FROM {{ ref('WORK', 'STG_LINEITEM_ORDERS') }} "STG_LINEITEM_ORDERS"
                
                LEFT JOIN {{ ref('WORK', 'DIM_CUSTOMER') }} "DIM_CUSTOMER"
                
                ON "STG_LINEITEM_ORDERS"."O_CUSTKEY" = "DIM_CUSTOMER"."C_CUSTKEY"
                
                AND "STG_LINEITEM_ORDERS"."O_ORDERDATE" BETWEEN "DIM_CUSTOMER"."SYSTEM_START_DATE" AND "DIM_CUSTOMER"."SYSTEM_END_DATE"
                
                /* The dimension lookup will not yield any matches due to a lack of historical data in the customer dimension. */
                
                LEFT JOIN {{ ref('WORK', 'DIM_PART') }} "DIM_PART"
                
                ON "STG_LINEITEM_ORDERS"."L_PARTKEY" = "DIM_PART"."P_PARTKEY"
                
                LEFT JOIN {{ ref('WORK', 'DIM_SUPPLIER') }} "DIM_SUPPLIER"
                
                ON "STG_LINEITEM_ORDERS"."L_SUPPKEY" = "DIM_SUPPLIER"."S_SUPPKEY"
                
                LEFT JOIN {{ ref('WORK', 'STG_PARTSUPP') }} "STG_PARTSUPP"
                
                ON "STG_LINEITEM_ORDERS"."L_PARTKEY" = "STG_PARTSUPP"."PS_PARTKEY" AND
                
                "STG_LINEITEM_ORDERS"."L_SUPPKEY" = "STG_PARTSUPP"."PS_SUPPKEY"
            name: STG_LINEITEM_ORDERS_DIM_LOOKUP
            noLinkRefs: []
      name: STG_LINEITEM_ORDERS_DIM_LOOKUP
      overrideSQL: false
      schema: ""
      sqlType: Stage
      type: sql
    stepCounter: ffebc1a0-c13e-4199-a7d4-70290db1dcb7
